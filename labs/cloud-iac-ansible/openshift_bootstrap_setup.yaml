---
- include: openshift_config_load.yaml

- name: OpenShift Bootstrap Setup
  hosts: localhost
  connection: local

  vars:
    openshift_bootstrap_bucket: "{{ ocp_install_infraID }}-infra"

  vars_prompt:
    - name: install_dir
      prompt: What is the Installation Directory?
      private: no

  pre_tasks:
    # create bucket
    - name: create bucket
      s3_bucket:
        name: "{{ openshift_bootstrap_bucket }}"
        state: present

      # upload ignition
    - name: Upload bootstrap.ign
      community.aws.s3_sync:
        bucket: "{{ openshift_bootstrap_bucket }}"
        key_prefix: /bootstrap.ign
        file_root: "{{ install_dir + '/bootstrap.ign' }}"
        #mode: put
        file_change_strategy: checksum

