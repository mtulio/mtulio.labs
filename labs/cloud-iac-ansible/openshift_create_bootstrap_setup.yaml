---
- include: openshift_config_load.yaml

- name: OpenShift Bootstrap Setup
  hosts: localhost
  connection: local

  vars_files:
    - "vars/compute/ocp-bootstrap-aws.yaml"

  vars_prompt:
    - name: install_dir
      prompt: What is the Installation Directory?
      private: no

  pre_tasks:
    - name: Create bucket
      s3_bucket:
        name: "{{ openshift_bootstrap_bucket }}"
        state: present

    # TODO: Make it indepotent
    - name: Upload bootstrap.ign
      amazon.aws.aws_s3:
        bucket: "{{ openshift_bootstrap_bucket }}"
        object: "/bootstrap.ign"
        src: "{{ install_dir + '/bootstrap.ign' }}"
        mode: put
